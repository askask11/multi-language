/*!Jianqing Gao multi-language 11-03-2021 */

class MultiLanguage{constructor(e="en",t=JSON.parse("[]"),a=null){this.defaultLang=e,this.externalJSON=t,this.registeredSelect=[],this.checkUserLanguage(),null!==a&&this.registerSelect(a),this.translate(this.externalJSON,this.getUserLanguage())}registerSelect(t){var e;null!==t&&"object"==typeof t&&"SELECT"===t.tagName&&(e=this.getUserLanguage(),this.makeSelect(t,e),t.addEventListener("change",e=>{this.translate(this.externalJSON,t.value)})),this.registeredSelect[this.registeredSelect.length]=t}makeSelect(e,t){for(var a=e.options,r=0,s=a.length;r<s;r++)if(a[r].value==t)return e.selectedIndex=r,!0;return!1}translate(e=this.externalJSON,t){this.setUserLanguage(t);for(var a=0,r=e.length;a<r;a++){var s=e[a],n=document.getElementById(s.id);if(null!==n){var g=s.langs;void 0!==g&&(d=this.getTranslatedLanguage(g,t),this.setElementText(n,d));var l=s.attr;if(void 0!==l)for(var i=Object.keys(l),u=0,h=i.length;u<h;u++){var c=i[u],d=this.getTranslatedLanguage(l[c],t);this.setElementAttribute(n,c,d)}}}for(u=0,r=this.registeredSelect.length;u<r;u++)this.makeSelect(this.registeredSelect[u],t)}isElementInput(e){return"TEXTAREA"==e.tagName||"INPUT"==e.tagName}getElementText(e){return this.isElementInput(e)?e.value:e.innerHTML}getTranslatedLanguage(e,t){t=e[t];return t=void 0===t?e[this.defaultLang]:t}setElementText(e,t){this.isElementInput(e)?this.setElementAttribute(e,"value",t):e.innerHTML=t}setElementAttribute(e,t,a){e.setAttribute(t,a)}getUserLanguage(){return localStorage.getItem("preferred-language")}checkUserLanguage(){var e=this.getUserLanguage();return null!==e&&""!==e||(this.setUserLanguage(this.defaultLang),!1)}setUserLanguage(e){localStorage.setItem("preferred-language",e)}addSheet(e){this.externalJSON=this.externalJSON.concat(e),this.translate(e,this.getUserLanguage())}}